async function loadProducts() {
  const t = await fetch('https://fakestoreapi.com/products');
  const e = await t.json();
  displayProducts(e);
}
const onIntersection = (t, e) => {
  t.forEach((t) => {
    if (t.isIntersecting) {
      const n = t.target;
      n.src = n.dataset.src;
      e.unobserve(n);
    }
  });
};
const observer = new IntersectionObserver(onIntersection, {
  root: null,
  threshold: 0.1,
});
function displayProducts(t) {
  const e = document.querySelector('#all-products .container');
  t.forEach((t) => {
    const n = document.createElement('div');
    n.classList.add('product');
    const c = document.createElement('div');
    c.classList.add('product-picture');
    const o = document.createElement('img');
    o.dataset.src = t.image;
    o.alt = `product: ${t.title}`;
    o.width = 350;
    o.height = 350;
    c.appendChild(o);
    observer.observe(o);
    const s = document.createElement('div');
    s.classList.add('product-info');
    const a = document.createElement('p');
    a.classList.add('categories');
    a.textContent = t.category;
    const d = document.createElement('p');
    d.classList.add('title');
    d.textContent = t.title;
    const r = document.createElement('p');
    r.classList.add('price');
    const i = document.createElement('span');
    i.textContent = `US$ ${t.price}`;
    r.appendChild(i);
    const l = document.createElement('button');
    l.textContent = 'Add to bag';
    s.appendChild(a);
    s.appendChild(d);
    s.appendChild(r);
    s.appendChild(l);
    n.appendChild(c);
    n.appendChild(s);
    e.appendChild(n);
  });
}
loadProducts();
const heavyOperationAsync = () => {
  for (let t = 0; t < 1e7; t++) {
    const e = Math.sqrt(t) * Math.sqrt(t);
  }
};
requestIdleCallback(heavyOperationAsync);
